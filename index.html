<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rise of Empires - Enhanced</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes workerMove { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(10px); } }
        @keyframes troopMarch { 0% { transform: translateX(0); } 100% { transform: translateX(100%); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.8; } }
        .worker-animated { animation: workerMove 2s ease-in-out infinite; }
        .troop-march { animation: troopMarch 4s linear infinite; }
        .resource-pulse { animation: pulse 2s ease-in-out infinite; }
        .hex { width: 60px; height: 52px; position: relative; margin: 2px; cursor: pointer; transition: all 0.3s; }
        .hex:hover { transform: scale(1.1); z-index: 10; }
        .hex-inner { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; 
            clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%); 
            font-size: 10px; font-weight: bold; border: 2px solid rgba(255,255,255,0.3); }
        .hex-owned { box-shadow: 0 0 15px rgba(251,191,36,0.6); }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const SoundManager = {
            ctx: null,
            init() { if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)(); },
            playTone(freq, dur) {
                this.init();
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.2, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + dur);
                osc.start(); osc.stop(this.ctx.currentTime + dur);
            },
            build() { this.playTone(400, 0.2); setTimeout(() => this.playTone(500, 0.2), 100); },
            train() { this.playTone(300, 0.15); setTimeout(() => this.playTone(400, 0.15), 100); },
            expand() { this.playTone(250, 0.3); setTimeout(() => this.playTone(350, 0.3), 150); }
        };

        const Crown = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M2 12l3-3 5 5 5-5 3 3v7H2v-7z"/><path d="M12 2v8"/></svg>;
        const Sword = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/><line x1="13" y1="19" x2="19" y2="13"/></svg>;
        const Users = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>;
        const Hammer = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m15 12-8.5 8.5c-.83.83-2.17.83-3 0a2.12 2.12 0 0 1 0-3L12 9"/></svg>;
        const Book = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>;
        const Trees = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 13v8"/><path d="m9 8-3 3h12l-3-3"/></svg>;
        const Wheat = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M2 22 16 8"/><path d="M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z"/></svg>;
        const Coins = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="8" cy="8" r="6"/><path d="M18.09 10.37A6 6 0 1 1 10.34 18"/></svg>;
        const Flag = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" y1="22" x2="4" y2="15"/></svg>;
        const Shield = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>;
        const ChevronUp = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="18 15 12 9 6 15"/></svg>;
        const MapIcon = p => <svg {...p} width="24" height="24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/></svg>;

        const MapView = ({ territory, color }) => {
            const size = 7;
            const tiles = Array.from({ length: size * size }, (_, i) => ({ id: i, owned: i < Math.min(territory, size * size) }));
            return (
                <div className="w-full max-w-2xl mx-auto">
                    {Array.from({ length: size }).map((_, row) => (
                        <div key={row} className="flex justify-center" style={{ marginLeft: row % 2 ? '31px' : '0' }}>
                            {Array.from({ length: size }).map((_, col) => {
                                const tile = tiles[row * size + col];
                                return (
                                    <div key={col} className="hex">
                                        <div className={`hex-inner ${tile.owned ? 'hex-owned' : ''}`}
                                            style={{ background: tile.owned ? `linear-gradient(135deg, ${color}, ${color}dd)` : 'linear-gradient(135deg, #444, #333)' }}>
                                            {tile.owned && Math.random() > 0.8 && <span className="text-white">‚öîÔ∏è</span>}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    ))}
                </div>
            );
        };

        const Game = () => {
            const [state, setState] = useState({
                nation: null, age: 'Ancient', 
                resources: { food: 200, wood: 200, gold: 100, knowledge: 0 },
                population: { current: 3, max: 10 }, territory: 1,
                units: { citizens: 3, soldiers: 0, archers: 0, cavalry: 0 },
                buildings: { farm: 0, lumberMill: 0, barracks: 0, library: 0, market: 0 },
                speed: 1, sound: true, notifications: []
            });
            const [started, setStarted] = useState(false);
            const [tab, setTab] = useState('map');

            const nations = {
                Romans: { name: 'Romans', bonus: '+20% soldier strength', color: '#8B0000' },
                Greeks: { name: 'Greeks', bonus: '+30% knowledge gain', color: '#1E40AF', resourceBonus: { knowledge: 1.3 } },
                Chinese: { name: 'Chinese', bonus: '+15% all resources', color: '#DC2626', resourceBonus: { food: 1.15, wood: 1.15, gold: 1.15, knowledge: 1.15 } }
            };

            const ages = ['Ancient', 'Classical', 'Medieval', 'Gunpowder', 'Modern'];

            const buildings = {
                farm: { name: 'Farm', cost: { wood: 50, food: 20 }, produces: { food: 5 }, Icon: Wheat },
                lumberMill: { name: 'Lumber Mill', cost: { wood: 40, food: 30 }, produces: { wood: 4 }, Icon: Trees },
                barracks: { name: 'Barracks', cost: { wood: 100, gold: 50 }, Icon: Shield },
                library: { name: 'Library', cost: { wood: 80, gold: 60 }, produces: { knowledge: 2 }, Icon: Book },
                market: { name: 'Market', cost: { wood: 75, gold: 100 }, produces: { gold: 3 }, Icon: Coins }
            };

            const units = {
                citizens: { name: 'Citizen', cost: { food: 50 }, Icon: Users },
                soldiers: { name: 'Soldier', cost: { food: 60, gold: 40 }, strength: 10, Icon: Sword },
                archers: { name: 'Archer', cost: { food: 50, wood: 30, gold: 35 }, strength: 8, Icon: Flag },
                cavalry: { name: 'Cavalry', cost: { food: 80, wood: 20, gold: 60 }, strength: 15, Icon: Crown }
            };

            useEffect(() => {
                if (!started || !state.nation) return;
                const interval = setInterval(() => {
                    setState(prev => {
                        const nation = nations[prev.nation];
                        const res = { ...prev.resources };
                        const bonus = nation.resourceBonus || {};
                        res.food += (prev.buildings.farm * 5 + prev.units.citizens * 0.5) * (bonus.food || 1);
                        res.wood += (prev.buildings.lumberMill * 4 + prev.units.citizens * 0.3) * (bonus.wood || 1);
                        res.gold += (prev.buildings.market * 3 + prev.units.citizens * 0.2) * (bonus.gold || 1);
                        res.knowledge += prev.buildings.library * 2 * (bonus.knowledge || 1);

                        let newAge = prev.age;
                        const ageIdx = ages.indexOf(prev.age);
                        if (ageIdx < ages.length - 1 && res.knowledge >= (ageIdx + 1) * 500 && prev.buildings.library > 0) {
                            newAge = ages[ageIdx + 1];
                        }

                        return { ...prev, resources: res, age: newAge };
                    });
                }, 1000 / state.speed);
                return () => clearInterval(interval);
            }, [started, state.speed, state.nation]);

            const build = (type) => {
                const b = buildings[type];
                if (Object.entries(b.cost).every(([r, c]) => state.resources[r] >= c)) {
                    if (state.sound) SoundManager.build();
                    setState(prev => {
                        const res = { ...prev.resources };
                        Object.entries(b.cost).forEach(([r, c]) => res[r] -= c);
                        return { ...prev, resources: res, buildings: { ...prev.buildings, [type]: prev.buildings[type] + 1 },
                            notifications: [...prev.notifications, `${b.name} built!`].slice(-3) };
                    });
                }
            };

            const train = (type) => {
                const u = units[type];
                const canAfford = Object.entries(u.cost).every(([r, c]) => state.resources[r] >= c);
                const needBarracks = type !== 'citizens' && state.buildings.barracks === 0;
                if (canAfford && state.population.current < state.population.max && !needBarracks) {
                    if (state.sound) SoundManager.train();
                    setState(prev => {
                        const res = { ...prev.resources };
                        Object.entries(u.cost).forEach(([r, c]) => res[r] -= c);
                        return { ...prev, resources: res, units: { ...prev.units, [type]: prev.units[type] + 1 },
                            population: { ...prev.population, current: prev.population.current + 1 },
                            notifications: [...prev.notifications, `${u.name} trained!`].slice(-3) };
                    });
                }
            };

            const expand = () => {
                const cost = state.territory * 100;
                if (state.resources.gold >= cost) {
                    if (state.sound) SoundManager.expand();
                    setState(prev => ({ ...prev, 
                        resources: { ...prev.resources, gold: prev.resources.gold - cost },
                        territory: prev.territory + 1,
                        population: { ...prev.population, max: prev.population.max + 5 },
                        notifications: [...prev.notifications, 'Territory expanded!'].slice(-3)
                    }));
                }
            };

            if (!started) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-amber-900 via-stone-800 to-slate-900 p-8 font-serif">
                        <div className="max-w-6xl mx-auto">
                            <div className="text-center mb-12">
                                <h1 className="text-7xl font-bold mb-4 bg-gradient-to-r from-amber-400 via-yellow-300 to-amber-500 bg-clip-text text-transparent">
                                    RISE OF EMPIRES
                                </h1>
                                <p className="text-2xl text-amber-200 italic">Forge Your Destiny Through the Ages</p>
                                <p className="text-sm text-amber-400 mt-2">‚ú® With Map View, Sounds & Animations ‚ú®</p>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                {Object.entries(nations).map(([key, nation]) => (
                                    <div key={key} onClick={() => { setState(p => ({ ...p, nation: key })); setStarted(true); SoundManager.init(); }}
                                        className="cursor-pointer bg-gradient-to-b from-stone-800 to-stone-900 border-4 border-amber-700 hover:border-amber-500 rounded-lg p-6 transform hover:scale-105 transition-all"
                                        style={{ borderColor: nation.color }}>
                                        <div className="flex items-center gap-3 mb-4">
                                            <Crown className="w-10 h-10" style={{ color: nation.color }} />
                                            <h2 className="text-3xl font-bold text-amber-100">{nation.name}</h2>
                                        </div>
                                        <div className="text-amber-300 bg-black/30 rounded p-3 border border-amber-700/50">
                                            <p className="text-sm text-amber-500 font-semibold">SPECIAL:</p>
                                            <p>{nation.bonus}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            const nation = nations[state.nation];
            const ageIdx = ages.indexOf(state.age);
            const nextAge = ages[ageIdx + 1];
            const knowledgeReq = (ageIdx + 1) * 500;

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-stone-900 to-amber-950 text-amber-50 p-4 font-serif">
                    <div className="bg-gradient-to-r from-amber-900/80 to-stone-900/80 border-2 border-amber-600 rounded-lg p-4 mb-4">
                        <div className="flex justify-between items-center flex-wrap gap-4">
                            <div className="flex items-center gap-3">
                                <Crown className="w-8 h-8" style={{ color: nation.color }} />
                                <div>
                                    <h1 className="text-2xl font-bold text-amber-100">{nation.name}</h1>
                                    <p className="text-sm text-amber-400">{nation.bonus}</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-2 bg-black/40 px-4 py-2 rounded border border-amber-700">
                                <ChevronUp className="w-5 h-5 text-amber-400" />
                                <div>
                                    <p className="text-xs text-amber-500">AGE</p>
                                    <p className="font-bold text-amber-200">{state.age}</p>
                                </div>
                            </div>
                            <div className="flex gap-3 text-sm">
                                <div className="flex items-center gap-2 bg-green-900/50 px-3 py-1 rounded border border-green-600 resource-pulse">
                                    <Wheat className="w-4 h-4" />
                                    <span className="font-bold">{Math.floor(state.resources.food)}</span>
                                </div>
                                <div className="flex items-center gap-2 bg-amber-900/50 px-3 py-1 rounded border border-amber-600 resource-pulse">
                                    <Trees className="w-4 h-4" />
                                    <span className="font-bold">{Math.floor(state.resources.wood)}</span>
                                </div>
                                <div className="flex items-center gap-2 bg-yellow-900/50 px-3 py-1 rounded border border-yellow-600 resource-pulse">
                                    <Coins className="w-4 h-4" />
                                    <span className="font-bold">{Math.floor(state.resources.gold)}</span>
                                </div>
                                <div className="flex items-center gap-2 bg-blue-900/50 px-3 py-1 rounded border border-blue-600 resource-pulse">
                                    <Book className="w-4 h-4" />
                                    <span className="font-bold">{Math.floor(state.resources.knowledge)}</span>
                                </div>
                            </div>
                            <div className="flex items-center gap-2 bg-purple-900/50 px-3 py-2 rounded border border-purple-600">
                                <Users className="w-5 h-5" />
                                <span className="font-bold">{state.population.current}/{state.population.max}</span>
                            </div>
                        </div>
                        {state.notifications.length > 0 && (
                            <div className="mt-3 space-y-1">
                                {state.notifications.map((n, i) => (
                                    <div key={i} className="text-sm text-amber-300 bg-black/40 px-3 py-1 rounded">‚ö° {n}</div>
                                ))}
                            </div>
                        )}
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                        <div className="space-y-4">
                            <div className="bg-gradient-to-br from-stone-800/90 to-stone-900/90 border-2 border-amber-600 rounded-lg p-4">
                                <h2 className="text-xl font-bold mb-3 text-amber-300 flex items-center gap-2">
                                    <Flag className="w-5 h-5" />Territory
                                </h2>
                                <div className="text-center mb-4">
                                    <p className="text-4xl font-bold text-amber-400">{state.territory}</p>
                                    <p className="text-sm text-amber-500">Provinces</p>
                                </div>
                                <button onClick={expand} disabled={state.resources.gold < state.territory * 100}
                                    className="w-full bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-500 hover:to-amber-600 disabled:from-gray-600 disabled:to-gray-700 text-white font-bold py-3 px-4 rounded border-2 transition-all">
                                    Expand ({state.territory * 100} Gold)
                                </button>
                            </div>

                            <div className="bg-gradient-to-br from-blue-900/90 to-indigo-900/90 border-2 border-blue-600 rounded-lg p-4">
                                <h2 className="text-xl font-bold mb-3 text-blue-300 flex items-center gap-2">
                                    <Book className="w-5 h-5" />Age Progress
                                </h2>
                                {nextAge ? (
                                    <div>
                                        <div className="flex justify-between text-sm mb-1">
                                            <span className="text-blue-400">To {nextAge}</span>
                                            <span className="text-blue-300">{Math.floor(state.resources.knowledge)}/{knowledgeReq}</span>
                                        </div>
                                        <div className="w-full bg-gray-700 rounded-full h-3 border border-blue-800">
                                            <div className="bg-gradient-to-r from-blue-500 to-cyan-400 h-full rounded-full transition-all"
                                                style={{ width: `${Math.min((state.resources.knowledge / knowledgeReq) * 100, 100)}%` }} />
                                        </div>
                                        {state.buildings.library === 0 && (
                                            <p className="text-sm text-yellow-400 mt-2">‚ö† Build Library to advance</p>
                                        )}
                                    </div>
                                ) : (
                                    <p className="text-green-400 font-bold text-center">üèÜ MAX AGE!</p>
                                )}
                            </div>

                            <div className="bg-gradient-to-br from-red-900/90 to-red-950/90 border-2 border-red-600 rounded-lg p-4">
                                <h2 className="text-xl font-bold mb-3 text-red-300 flex items-center gap-2">
                                    <Sword className="w-5 h-5" />Army
                                </h2>
                                <div className="space-y-2">
                                    {Object.entries(state.units).map(([type, count]) => {
                                        if (count > 0 && type !== 'citizens') {
                                            return (
                                                <div key={type} className="flex justify-between bg-black/40 p-2 rounded">
                                                    <span className="text-amber-300 flex items-center gap-2">
                                                        {units[type].name}s <span className="troop-march">‚öîÔ∏è</span>
                                                    </span>
                                                    <span className="font-bold text-red-400">{count}</span>
                                                </div>
                                            );
                                        }
                                        return null;
                                    })}
                                </div>
                            </div>

                            <div className="bg-gradient-to-br from-green-900/90 to-green-950/90 border-2 border-green-600 rounded-lg p-4">
                                <h2 className="text-xl font-bold mb-3 text-green-300 flex items-center gap-2">
                                    <Users className="w-5 h-5" />Workers
                                </h2>
                                <div className="space-y-2">
                                    {state.buildings.farm > 0 && (
                                        <div>
                                            <p className="text-xs text-green-400">Farms: {state.buildings.farm}</p>
                                            <div className="flex gap-1">
                                                {Array.from({ length: Math.min(state.buildings.farm, 5) }).map((_, i) => (
                                                    <span key={i} className="worker-animated">üåæ</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {state.buildings.lumberMill > 0 && (
                                        <div>
                                            <p className="text-xs text-green-400">Lumber: {state.buildings.lumberMill}</p>
                                            <div className="flex gap-1">
                                                {Array.from({ length: Math.min(state.buildings.lumberMill, 5) }).map((_, i) => (
                                                    <span key={i} className="worker-animated">ü™ì</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {state.units.citizens > 0 && (
                                        <div>
                                            <p className="text-xs text-green-400">Citizens: {state.units.citizens}</p>
                                            <div className="flex gap-1">
                                                {Array.from({ length: Math.min(state.units.citizens, 8) }).map((_, i) => (
                                                    <span key={i} className="worker-animated">üë∑</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="lg:col-span-2 space-y-4">
                            <div className="flex gap-2 bg-stone-900/80 p-2 rounded-lg border-2 border-amber-700">
                                {['map', 'buildings', 'units'].map(t => (
                                    <button key={t} onClick={() => setTab(t)}
                                        className={`flex-1 py-2 px-4 rounded font-bold transition-all ${tab === t
                                            ? 'bg-gradient-to-r from-amber-600 to-amber-700 text-white border-2 border-amber-500'
                                            : 'bg-stone-800 text-amber-400 hover:bg-stone-700'}`}>
                                        {t === 'map' && <MapIcon className="inline w-5 h-5 mr-2" />}
                                        {t === 'buildings' && <Hammer className="inline w-5 h-5 mr-2" />}
                                        {t === 'units' && <Sword className="inline w-5 h-5 mr-2" />}
                                        {t.toUpperCase()}
                                    </button>
                                ))}
                            </div>

                            {tab === 'map' && (
                                <div className="bg-gradient-to-br from-stone-800/90 to-stone-900/90 border-2 border-amber-700 rounded-lg p-6">
                                    <h2 className="text-2xl font-bold mb-4 text-amber-300 text-center">Empire Map</h2>
                                    <MapView territory={state.territory} color={nation.color} />
                                    <p className="text-center text-amber-400 mt-4">
                                        Controlling <span className="font-bold text-amber-300">{state.territory}</span> provinces
                                    </p>
                                </div>
                            )}

                            {tab === 'buildings' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {Object.entries(buildings).map(([key, b]) => {
                                        const Icon = b.Icon;
                                        const canAfford = Object.entries(b.cost).every(([r, c]) => state.resources[r] >= c);
                                        return (
                                            <div key={key} className="bg-gradient-to-br from-stone-800/90 to-stone-900/90 border-2 border-amber-700 rounded-lg p-4 hover:border-amber-500 transition-all">
                                                <div className="flex items-start gap-3 mb-3">
                                                    <Icon className="w-8 h-8 text-amber-400" />
                                                    <div>
                                                        <h3 className="text-lg font-bold text-amber-200">{b.name}</h3>
                                                        <p className="text-sm text-gray-400">Owned: {state.buildings[key]}</p>
                                                    </div>
                                                </div>
                                                <div className="text-sm mb-3">
                                                    <span className="text-amber-500 font-semibold">Cost: </span>
                                                    {Object.entries(b.cost).map(([r, amt], i) => (
                                                        <span key={r} className={state.resources[r] < amt ? 'text-red-400' : 'text-green-400'}>
                                                            {i > 0 && ', '}{amt} {r}
                                                        </span>
                                                    ))}
                                                    {b.produces && Object.keys(b.produces).length > 0 && (
                                                        <div className="mt-1">
                                                            <span className="text-amber-500 font-semibold">Produces: </span>
                                                            {Object.entries(b.produces).map(([r, amt], i) => (
                                                                <span key={r} className="text-blue-400">
                                                                    {i > 0 && ', '}+{amt} {r}/s
                                                                </span>
                                                            ))}
                                                        </div>
                                                    )}
                                                </div>
                                                <button onClick={() => build(key)} disabled={!canAfford}
                                                    className="w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-600 disabled:from-gray-600 disabled:to-gray-700 text-white font-bold py-2 px-4 rounded transition-all">
                                                    üî® Build
                                                </button>
                                            </div>
                                        );
                                    })}
                                </div>
                            )}

                            {tab === 'units' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {Object.entries(units).map(([key, u]) => {
                                        const Icon = u.Icon;
                                        const canAfford = Object.entries(u.cost).every(([r, c]) => state.resources[r] >= c);
                                        const hasSpace = state.population.current < state.population.max;
                                        const needBarracks = key !== 'citizens' && state.buildings.barracks === 0;
                                        return (
                                            <div key={key} className="bg-gradient-to-br from-red-900/80 to-red-950/80 border-2 border-red-700 rounded-lg p-4 hover:border-red-500 transition-all">
                                                <div className="flex items-start gap-3 mb-3">
                                                    <Icon className="w-8 h-8 text-red-400" />
                                                    <div>
                                                        <h3 className="text-lg font-bold text-red-200">{u.name}</h3>
                                                        <p className="text-sm text-gray-400">Count: {state.units[key]}</p>
                                                        {u.strength && <p className="text-sm text-amber-400">‚öî Strength: {u.strength}</p>}
                                                    </div>
                                                </div>
                                                <div className="text-sm mb-3">
                                                    <span className="text-red-400 font-semibold">Cost: </span>
                                                    {Object.entries(u.cost).map(([r, amt], i) => (
                                                        <span key={r} className={state.resources[r] < amt ? 'text-red-400' : 'text-green-400'}>
                                                            {i > 0 && ', '}{amt} {r}
                                                        </span>
                                                    ))}
                                                    {!hasSpace && <p className="text-yellow-400 mt-1">‚ö† Pop cap reached</p>}
                                                    {needBarracks && <p className="text-yellow-400 mt-1">‚ö† Requires Barracks</p>}
                                                </div>
                                                <button onClick={() => train(key)} disabled={!canAfford || !hasSpace || needBarracks}
                                                    className="w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 disabled:from-gray-600 disabled:to-gray-700 text-white font-bold py-2 px-4 rounded transition-all">
                                                    ‚öîÔ∏è Train
                                                </button>
                                            </div>
                                        );
                                    })}
                                </div>
                            )}
                        </div>
                    </div>

                    <div className="fixed bottom-4 right-4 space-y-2">
                        <div className="bg-stone-900/95 border-2 border-amber-600 rounded-lg p-3">
                            <p className="text-xs text-amber-500 mb-2">SPEED</p>
                            <div className="flex gap-2">
                                {[0.5, 1, 2, 3].map(s => (
                                    <button key={s} onClick={() => setState(p => ({ ...p, speed: s }))}
                                        className={`px-3 py-1 rounded font-bold ${state.speed === s ? 'bg-amber-600 text-white' : 'bg-stone-700 text-amber-400'}`}>
                                        {s}x
                                    </button>
                                ))}
                            </div>
                        </div>
                        <button onClick={() => setState(p => ({ ...p, sound: !p.sound }))}
                            className={`w-full px-4 py-2 rounded font-bold ${state.sound ? 'bg-green-600' : 'bg-gray-600'} text-white`}>
                            {state.sound ? 'üîä ON' : 'üîá OFF'}
                        </button>
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<Game />);
    </script>
</body>
</html>